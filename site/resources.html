<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0A0A0A">
    <title>District Resources – NYS District Dashboard</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .resources-table-wrap {
            overflow-x: auto;
            margin-top: 1rem;
        }
        .resources-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }
        .resources-table th,
        .resources-table td {
            padding: 10px 12px;
            text-align: left;
            border-bottom: 1px solid #333;
        }
        .resources-table th {
            cursor: pointer;
            user-select: none;
            color: #FFFFFF;
            background: #121212;
            position: sticky;
            top: 0;
            white-space: nowrap;
        }
        .resources-table th:hover {
            color: #00A3FF;
        }
        .resources-table th .sort-arrow {
            margin-left: 4px;
            font-size: 0.75rem;
        }
        .resources-table tr:hover td {
            background: #222;
        }
        .resources-table td {
            color: #E0E0E0;
        }
        .resources-table a {
            color: #00A3FF;
            text-decoration: none;
        }
        .resources-table a:hover {
            color: #33B8FF;
            text-decoration: underline;
        }
        .resources-table .empty-cell {
            color: #555;
        }
        .back-link {
            display: inline-block;
            margin-bottom: 1rem;
            color: #00A3FF;
            text-decoration: none;
            font-weight: 600;
        }
        .back-link:hover {
            color: #33B8FF;
            text-decoration: underline;
        }
        .contribute-section code {
            background: #0A0A0A;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.85rem;
            color: #00A3FF;
        }
        .contribute-section ol {
            margin-left: 1.5rem;
            margin-top: 0.75rem;
        }
        .contribute-section li {
            margin-bottom: 0.5rem;
            color: #E0E0E0;
        }
        .filter-bar {
            margin-top: 1rem;
        }
        .filter-bar label {
            font-weight: 600;
            color: #E0E0E0;
            font-size: 0.875rem;
            margin-right: 0.5rem;
        }
        .filter-bar select {
            padding: 0.5rem;
            font-size: 0.9rem;
            border: 1px solid #333;
            border-radius: 4px;
            background: #0A0A0A;
            color: #E0E0E0;
            cursor: pointer;
        }
        .filter-bar select:focus {
            outline: none;
            border-color: #00A3FF;
            box-shadow: 0 0 0 3px rgba(0,163,255,0.2);
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>NYS District Dashboard</h1>
            <p class="subtitle">District Resources Appendix</p>
        </div>
    </header>

    <main class="container">
        <a href="index.html" class="back-link">← Back to Dashboard</a>

        <section>
            <h2>District Resources</h2>
            <p>
                A directory of official district websites, board documents, budget pages, and
                transparency portals for all tracked districts. Community members are welcome to
                help fill in missing links.
            </p>

            <div class="filter-bar">
                <label for="bocesFilterRes">Filter by BOCES Region:</label>
                <select id="bocesFilterRes">
                    <option value="">All Regions</option>
                </select>
            </div>

            <div class="resources-table-wrap">
                <table class="resources-table" id="resourcesTable">
                    <thead>
                        <tr>
                            <th data-col="name">District <span class="sort-arrow"></span></th>
                            <th data-col="boces">BOCES Region <span class="sort-arrow"></span></th>
                            <th data-col="website_url">Website <span class="sort-arrow"></span></th>
                            <th data-col="board_docs_url">Board Docs <span class="sort-arrow"></span></th>
                            <th data-col="budget_url">Budget <span class="sort-arrow"></span></th>
                            <th data-col="transparency_portal_url">Transparency <span class="sort-arrow"></span></th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>

        <section class="contribute-section">
            <h2>How to Contribute</h2>
            <p>
                Many resource links are still missing. You can help by submitting a pull request
                to add URLs for your district.
            </p>
            <ol>
                <li>Fork the <a href="https://github.com/evcatalyst/nys-district-dashboard" target="_blank">repository on GitHub</a>.</li>
                <li>Edit <code>config/resources.json</code> — find your district and fill in the empty URL fields.</li>
                <li>Commit your changes and open a Pull Request.</li>
                <li>A maintainer will review and merge your contribution.</li>
            </ol>
            <p>
                Each district entry has these fields:
                <code>website_url</code>, <code>board_docs_url</code>,
                <code>board_meetings_url</code>, <code>budget_url</code>, and
                <code>transparency_portal_url</code>. Only fill in URLs you can verify
                point to official district pages.
            </p>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>
                Built with public data from NYSED and school districts.
                <a href="https://github.com/evcatalyst/nys-district-dashboard" target="_blank">View Source on GitHub</a>
            </p>
        </div>
    </footer>

    <script>
    (function () {
        "use strict";

        var data = [];
        var sortCol = "name";
        var sortAsc = true;
        var bocesFilter = "";

        var linkCols = ["website_url", "board_docs_url", "budget_url", "transparency_portal_url"];
        var colLabels = {
            website_url: "Website",
            board_docs_url: "Board Docs",
            budget_url: "Budget",
            transparency_portal_url: "Transparency"
        };

        function linkCell(url, label) {
            if (!url) return '<span class="empty-cell">\u2014</span>';
            return '<a href="' + url + '" target="_blank" rel="noopener">' + label + '</a>';
        }

        function render() {
            var filtered = bocesFilter
                ? data.filter(function (d) { return d.boces === bocesFilter; })
                : data.slice();

            filtered.sort(function (a, b) {
                var va = (a[sortCol] || "").toLowerCase();
                var vb = (b[sortCol] || "").toLowerCase();
                if (va < vb) return sortAsc ? -1 : 1;
                if (va > vb) return sortAsc ? 1 : -1;
                return 0;
            });

            var tbody = document.querySelector("#resourcesTable tbody");
            tbody.innerHTML = filtered.map(function (d) {
                return "<tr>" +
                    "<td>" + d.name + "</td>" +
                    "<td>" + (d.boces || "\u2014") + "</td>" +
                    "<td>" + linkCell(d.website_url, "Visit") + "</td>" +
                    "<td>" + linkCell(d.board_docs_url, "Docs") + "</td>" +
                    "<td>" + linkCell(d.budget_url, "Budget") + "</td>" +
                    "<td>" + linkCell(d.transparency_portal_url, "Portal") + "</td>" +
                    "</tr>";
            }).join("");

            // Update sort arrows
            document.querySelectorAll("#resourcesTable th").forEach(function (th) {
                var arrow = th.querySelector(".sort-arrow");
                if (th.dataset.col === sortCol) {
                    arrow.textContent = sortAsc ? "\u25B2" : "\u25BC";
                } else {
                    arrow.textContent = "";
                }
            });
        }

        function populateBoces() {
            var regions = [];
            data.forEach(function (d) {
                if (d.boces && regions.indexOf(d.boces) === -1) regions.push(d.boces);
            });
            regions.sort();
            var sel = document.getElementById("bocesFilterRes");
            regions.forEach(function (r) {
                var opt = document.createElement("option");
                opt.value = r;
                opt.textContent = r;
                sel.appendChild(opt);
            });
            sel.addEventListener("change", function () {
                bocesFilter = this.value;
                render();
            });
        }

        function initSort() {
            document.querySelectorAll("#resourcesTable th").forEach(function (th) {
                th.addEventListener("click", function () {
                    var col = this.dataset.col;
                    if (sortCol === col) {
                        sortAsc = !sortAsc;
                    } else {
                        sortCol = col;
                        sortAsc = true;
                    }
                    render();
                });
            });
        }

        fetch("data/resources.json")
            .then(function (r) { return r.json(); })
            .then(function (json) {
                data = json;
                populateBoces();
                initSort();
                render();
            })
            .catch(function (err) {
                console.error("Failed to load resources:", err);
                document.querySelector("#resourcesTable tbody").innerHTML =
                    '<tr><td colspan="6" style="text-align:center;color:#666;">Failed to load resource data.</td></tr>';
            });
    })();
    </script>
</body>
</html>
